<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Responsive Meta Tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Finder</title>
    <!-- SEO Meta Tags -->
    <meta name="description" content="Discover recipes based on what's in your fridge.">
    <meta name="keywords" content="recipes, cooking, ingredients, food, meal planning">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap Icons CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Custom Styles -->
    <style>
        body {
            background-color: #f8f9fa;
        }
        h2 {
            color: #343a40;
        }
        /* Additional custom styles can be added here */
    </style>
</head>
<body>
<!-- Navigation Bar -->
<header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <!-- Profile Icon -->
            <a class="navbar-brand d-flex align-items-center" href="userprofile.html" aria-label="Profile">
                <i class="bi bi-person-circle fs-3"></i>
            </a>
            <!-- Navbar Brand -->
            <a class="navbar-brand ms-2" href="index.html">Recipe Finder</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Rest of the navbar items -->
            <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
                <form class="d-flex me-auto">
                    <input class="form-control me-2" type="search" placeholder="Search for recipes..." aria-label="Search">
                </form>
                <div>
                    <button id="refreshPageBtn" class="btn btn-warning me-2">Refresh Page</button>
                    <button class="btn btn-primary me-2">My Fridge</button>
                    <!-- Updated Upload Ingredients Button -->
                    <button class="btn btn-secondary me-2" data-bs-toggle="modal" data-bs-target="#uploadIngredientModal">Upload Ingredients</button>
                    <button id="addRecipeBtn" class="btn btn-success me-2">+ Add Recipe</button>
                    <button id="clearFridgeBtn" class="btn btn-danger">Clear Fridge</button>
                </div>
            </div>
        </div>
    </nav>
</header>

<!-- Main Content -->
<main>


    <!-- Top Recipes -->
    <section class="container my-4">
        <h2 class="mb-3">Top Recipes</h2>
        <div class="row">
            <!-- Recipe Card 1 -->
            <div class="col-md-4">
                <div class="card">
                    <img src="images/recipe1.jpg" class="card-img-top" alt="Spaghetti Carbonara">
                    <div class="card-body">
                        <h5 class="card-title">Spaghetti Carbonara</h5>
                        <p class="card-text">⭐⭐⭐⭐</p>
                        <a href="#" class="btn btn-primary">View Recipe</a>
                    </div>
                </div>
            </div>
            <!-- Recipe Card 2 -->
            <div class="col-md-4">
                <div class="card">
                    <img src="images/recipe2.jpg" class="card-img-top" alt="Chicken Curry">
                    <div class="card-body">
                        <h5 class="card-title">Chicken Curry</h5>
                        <p class="card-text">⭐⭐⭐</p>
                        <a href="#" class="btn btn-primary">View Recipe</a>
                    </div>
                </div>
            </div>
            <!-- Recipe Card 3 -->
            <div class="col-md-4">
                <div class="card">
                    <img src="images/recipe3.jpg" class="card-img-top" alt="Vegetable Stir Fry">
                    <div class="card-body">
                        <h5 class="card-title">Vegetable Stir Fry</h5>
                        <p class="card-text">⭐⭐⭐⭐⭐</p>
                        <a href="#" class="btn btn-primary">View Recipe</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- Show More Recipes Button -->
        <div class="text-center my-4">
            <a href="recipes.html" class="btn btn-outline-primary btn-lg">Show More Recipes</a>
        </div>
    </section>

    <!-- Social Feed -->
    <section class="container my-4">
        <h2 class="mb-3">Social Feed</h2>
        <!-- Add Comment Button -->
        <div class="mb-3 text-end">
            <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#addCommentModal">
                <i class="bi bi-pencil-square"></i> Add Comment
            </button>
        </div>

        <div class="row social-feed-row">
            <!-- Social Post 1 -->
            <div class="col-md-6">
                <div class="card mb-3">
                    <div class="card-header d-flex align-items-center">
                        <img src="images/user1.jpg" alt="User123" class="rounded-circle me-2" width="40" height="40">
                        <strong>User123</strong>
                        <small class="text-muted ms-auto">3 days ago</small>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Just tried the Spaghetti Carbonara recipe, and it was amazing!</p>
                    </div>
                    <div class="card-footer d-flex align-items-center">
                        <button class="btn btn-outline-primary btn-sm like-button">
                            <i class="bi bi-hand-thumbs-up"></i> Like
                        </button>
                        <span class="ms-2 like-count">0 Likes</span>
                        <button class="btn btn-outline-secondary btn-sm ms-auto">
                            <i class="bi bi-chat-dots"></i> Comment
                        </button>
                    </div>
                </div>
            </div>
            <!-- Social Post 2 -->
            <div class="col-md-6">
                <div class="card mb-3">
                    <div class="card-header d-flex align-items-center">
                        <img src="images/user2.jpg" alt="ChefMike" class="rounded-circle me-2" width="40" height="40">
                        <strong>ChefMike</strong>
                        <small class="text-muted ms-auto">5 days ago</small>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Added a new recipe for vegan brownies. Check it out!</p>
                    </div>
                    <div class="card-footer d-flex align-items-center">
                        <button class="btn btn-outline-primary btn-sm like-button">
                            <i class="bi bi-hand-thumbs-up"></i> Like
                        </button>
                        <span class="ms-2 like-count">0 Likes</span>
                        <button class="btn btn-outline-secondary btn-sm ms-auto">
                            <i class="bi bi-chat-dots"></i> Comment
                        </button>
                    </div>
                </div>
            </div>
            <!-- Add more social posts as needed -->
        </div>

        <!-- Show More Socials Button -->
        <div class="text-center my-4">
            <a href="socials.html" class="btn btn-outline-primary btn-lg">Show More Socials</a>
        </div>
    </section>
</main>

<!-- Add Comment Modal -->
<div class="modal fade" id="addCommentModal" tabindex="-1" aria-labelledby="addCommentModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="addCommentModalLabel" class="modal-title">Add a Comment</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="commentForm">
                    <div class="mb-3">
                        <label for="commentText" class="form-label">Your Comment</label>
                        <textarea class="form-control" id="commentText" rows="3" required></textarea>
                    </div>
                    <!-- Optionally, add fields for username or other info -->
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="commentForm" class="btn btn-primary">Post Comment</button>
            </div>
        </div>
    </div>
</div>

<!-- Upload Ingredient Modal -->
<div class="modal fade" id="uploadIngredientModal" tabindex="-1" aria-labelledby="uploadIngredientModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="uploadIngredientModalLabel" class="modal-title">Upload Ingredient</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="uploadIngredientForm">
                    <div class="mb-3">
                        <label for="ingredientCategory" class="form-label">Category</label>
                        <input type="text" class="form-control" id="ingredientCategory" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientName" class="form-label">Name</label>
                        <input type="text" class="form-control" id="ingredientName" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientServingSize" class="form-label">Average Serving Size</label>
                        <input type="text" class="form-control" id="ingredientServingSize" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientCalories" class="form-label">Calories</label>
                        <input type="number" class="form-control" id="ingredientCalories" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientCarbs" class="form-label">Carbs (g)</label>
                        <input type="number" step="0.1" class="form-control" id="ingredientCarbs" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientProtein" class="form-label">Protein (g)</label>
                        <input type="number" step="0.1" class="form-control" id="ingredientProtein" required>
                    </div>
                    <div class="mb-3">
                        <label for="ingredientSugar" class="form-label">Sugar (g)</label>
                        <input type="number" step="0.1" class="form-control" id="ingredientSugar" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="uploadIngredientForm" class="btn btn-primary">Add Ingredient</button>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="bg-light py-4">
    <div class="container text-center">
        <p>&copy; 2023 Recipe Finder. All rights reserved.</p>
    </div>
</footer>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YOaK6t6VxF7E7lAvb/5PjpV+0zzw8eSDdBke6dZr1EJZ6xI5Xl4eWc3rFhwHdVQ" crossorigin="anonymous"></script>
<!-- Custom JavaScript -->
<script>
    // Clear Fridge Functionality
    document.getElementById('clearFridgeBtn').addEventListener('click', function() {
        // Add functionality to clear fridge items
        alert('Fridge cleared!');
    });

    // Refresh Page Functionality
    document.getElementById('refreshPageBtn').addEventListener('click', function() {
        location.reload();
    });

    // Add Recipe Functionality
    document.getElementById('addRecipeBtn').addEventListener('click', function() {
        // Add functionality to add a new recipe
        alert('Redirecting to Add Recipe page.');
        // Example: window.location.href = 'add_recipe.html';
    });

    // Add Comment Functionality
    document.getElementById('commentForm').addEventListener('submit', function(event) {
        event.preventDefault();

        // Get the comment text
        const commentText = document.getElementById('commentText').value;

        // Close the modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('addCommentModal'));
        modal.hide();

        // Clear the form
        document.getElementById('commentForm').reset();

        // Add the new comment to the social feed
        addCommentToFeed(commentText);
    });

    function addCommentToFeed(commentText) {
        // Create elements for the new post
        const postCol = document.createElement('div');
        postCol.className = 'col-md-6';

        const postCard = document.createElement('div');
        postCard.className = 'card mb-3';

        const cardHeader = document.createElement('div');
        cardHeader.className = 'card-header d-flex align-items-center';

        // Placeholder user image and name
        const userImage = document.createElement('img');
        userImage.src = 'images/default_user.jpg'; // Ensure this image exists
        userImage.alt = 'You';
        userImage.className = 'rounded-circle me-2';
        userImage.width = 40;
        userImage.height = 40;

        const userName = document.createElement('strong');
        userName.textContent = 'You';

        const timeStamp = document.createElement('small');
        timeStamp.className = 'text-muted ms-auto';
        timeStamp.textContent = 'Just now';

        cardHeader.appendChild(userImage);
        cardHeader.appendChild(userName);
        cardHeader.appendChild(timeStamp);

        const cardBody = document.createElement('div');
        cardBody.className = 'card-body';

        const cardText = document.createElement('p');
        cardText.className = 'card-text';
        cardText.textContent = commentText;

        cardBody.appendChild(cardText);

        const cardFooter = document.createElement('div');
        cardFooter.className = 'card-footer d-flex align-items-center';

        const likeButton = document.createElement('button');
        likeButton.className = 'btn btn-outline-primary btn-sm like-button';
        likeButton.innerHTML = '<i class="bi bi-hand-thumbs-up"></i> Like';

        const likeCountSpan = document.createElement('span');
        likeCountSpan.className = 'ms-2 like-count';
        likeCountSpan.textContent = '0 Likes';
        likeCountSpan.setAttribute('data-likes', '0');

        const commentButton = document.createElement('button');
        commentButton.className = 'btn btn-outline-secondary btn-sm ms-auto';
        commentButton.innerHTML = '<i class="bi bi-chat-dots"></i> Comment';

        cardFooter.appendChild(likeButton);
        cardFooter.appendChild(likeCountSpan);
        cardFooter.appendChild(commentButton);

        postCard.appendChild(cardHeader);
        postCard.appendChild(cardBody);
        postCard.appendChild(cardFooter);

        postCol.appendChild(postCard);

        // Insert the new post at the top of the social feed
        const socialFeedRow = document.querySelector('.social-feed-row');
        socialFeedRow.insertBefore(postCol, socialFeedRow.firstChild);

        // Add event listener for the like button
        likeButton.addEventListener('click', function() {
            let likeCount = parseInt(likeCountSpan.getAttribute('data-likes')) || 0;

            // Toggle like/unlike
            if (this.classList.contains('liked')) {
                likeCount--;
                this.classList.remove('liked');
                this.innerHTML = '<i class="bi bi-hand-thumbs-up"></i> Like';
            } else {
                likeCount++;
                this.classList.add('liked');
                this.innerHTML = '<i class="bi bi-hand-thumbs-up-fill"></i> Liked';
            }

            // Update like count display
            likeCountSpan.setAttribute('data-likes', likeCount);
            likeCountSpan.textContent = likeCount + (likeCount === 1 ? ' Like' : ' Likes');
        });
    }

    // Upload Ingredient Functionality
    document.getElementById('uploadIngredientForm').addEventListener('submit', function(event) {
        event.preventDefault();

        // Get form values
        const category = document.getElementById('ingredientCategory').value;
        const name = document.getElementById('ingredientName').value;
        const servingSize = document.getElementById('ingredientServingSize').value;
        const calories = document.getElementById('ingredientCalories').value;
        const carbs = document.getElementById('ingredientCarbs').value;
        const protein = document.getElementById('ingredientProtein').value;
        const sugar = document.getElementById('ingredientSugar').value;

        // Add the new ingredient to the table
        addIngredientToTable({
            category,
            name,
            servingSize,
            calories,
            carbs,
            protein,
            sugar
        });

        // Close the modal
        const modal = bootstrap.Modal.getInstance(document.getElementById('uploadIngredientModal'));
        modal.hide();

        // Clear the form
        document.getElementById('uploadIngredientForm').reset();
    });

    function addIngredientToTable(ingredient) {
        const tableBody = document.querySelector('#ingredientsTable tbody');

        const row = document.createElement('tr');

        row.innerHTML = `
                <td>${ingredient.category}</td>
                <td>${ingredient.name}</td>
                <td>${ingredient.servingSize}</td>
                <td>${ingredient.calories}</td>
                <td>${ingredient.carbs}g</td>
                <td>${ingredient.protein}g</td>
                <td>${ingredient.sugar}g</td>
                <td><input type="checkbox" aria-label="${ingredient.name} used"></td>
                <td>
                    <button class="btn btn-info btn-sm">Details</button>
                    <button class="btn btn-danger btn-sm">Delete</button>
                </td>
            `;

        tableBody.appendChild(row);
    }

    // Like Button Functionality for Existing Posts
    document.addEventListener('DOMContentLoaded', function() {
        const likeButtons = document.querySelectorAll('.like-button');
        likeButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                const cardFooter = this.parentElement;
                const likeCountSpan = cardFooter.querySelector('.like-count');
                let likeCount = parseInt(likeCountSpan.getAttribute('data-likes')) || 0;

                // Toggle like/unlike
                if (this.classList.contains('liked')) {
                    likeCount--;
                    this.classList.remove('liked');
                    this.innerHTML = '<i class="bi bi-hand-thumbs-up"></i> Like';
                } else {
                    likeCount++;
                    this.classList.add('liked');
                    this.innerHTML = '<i class="bi bi-hand-thumbs-up-fill"></i> Liked';
                }

                // Update like count display
                likeCountSpan.setAttribute('data-likes', likeCount);
                likeCountSpan.textContent = likeCount + (likeCount === 1 ? ' Like' : ' Likes');
            });
        });
    });
</script>
</body>
</html>